@model IEnumerable<SystemExamWebSite.DataBase.tbl_Exam>
@using SystemExamWebSite.DataBase;
@{
    Layout = null;
    ExamSystemEntities db = new ExamSystemEntities();

}


<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>  إمتحان أونلاين | الامتحانات المتاحة </title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <meta content="نظام إمتحان أونلاين" name="description" />
    <meta content="MohamedEid" name="author" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <!-- App favicon -->
    <link rel="shortcut icon" href="~/assets/images/logonew.png">
    <!-- App css -->
    <link href="~/assets/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
    <link href="~/assets/css/icons.css" rel="stylesheet" type="text/css" />
    <link href="~/assets/css/metismenu.min.css" rel="stylesheet" type="text/css" />
    <link href="~/assets/css/style.css" rel="stylesheet" type="text/css" />

    <script src="~/assets/js/modernizr.min.js"></script>


</head>


<body>

    <!-- Begin page -->
    <div id="wrapper" class="mt-2">
        <!-- ========== Left Sidebar Start ========== -->
        <div class="left side-menu">
            <div class="p-2 m-0 text-center">
                <h3> <img src="~/assets/images/logoblue.png" width="120" height="50" /></h3>
            </div>

            <!--- Sidemenu -->
            <div id="sidebar-menu" class="pt-0 mt-0">
                <!-- Left Menu Start -->
                <ul class="metismenu text-right" id="side-menu">
                    <li>
                        <a href="@Url.Action("Index","Student")">
                            <span> الرئيسية </span>   <i class="ti-bookmark"></i>
                        </a>
                    </li>
                    <li>
                        <a href="@Url.Action("AvaliableExam","Student")">
                            <span> الامتحانات المتاحة </span> <i class="ti-filter"></i>
                        </a>
                    </li>
                    <li>
                        <a href="@Url.Action("ExamResult","Student")">
                            <span> نتائج الامتحانات </span>  <i class="ti-bar-chart"></i>
                        </a>
                    </li>
                    <li>
                        <a href="javascript: void(0);">
                            <span> الإعدادت </span>  <i class="ti-settings"></i>
                        </a>
                        <ul class="nav-second-level" aria-expanded="false">
                            <li><a href="@Url.Action("DetailsMe","Student")">تفاصيل الحساب</a></li>
                            <li><a href="@Url.Action("EditMe","Student")">تعديل الحساب</a></li>
                            <li><a href="@Url.Action("DeleteMe","Student")">حذف الحساب</a></li>
                        </ul>
                    </li>
                    <li>
                        <a href="@Url.Action("Logout","Student")">
                            <span> تسجيل خروج </span>  <i class="ti-export"></i>
                        </a>
                    </li>
                </ul>

            </div>
            <!-- Sidebar -->
            <div class="clearfix"></div>

        </div>
        <!-- Left Sidebar End -->
        <!-- ============================================================== -->
        <!-- Start right Content here -->
        <!-- ============================================================== -->

        <div class="content-page">
            <!-- Start content -->
            <div class="content">
                <div class="container-fluid">

                    <div class="row">
                        <div class="col-sm-12">
                            <h4 class="header-title m-t-0 m-b-20 text-right">  عرض الامتحانات المتاحة <span class="ti-agenda"> </span></h4>

                            <hr />
                            <br />
                            @if (Model.Count() == 0)
                            {

                                <p class="text-center text-muted" style="font-size:20px"> لا توجد بيانات متاحة لعرضها </p>
                            }
                            else
                            {

                                foreach (var item in Model)
                                {

                                    var McqT = db.tbl_QuestionMCQ.Where(a => a.Exam_Id == item.Exam_Id);
                                    var TFT = db.tbl_QuestionTrueFalse.Where(a => a.Exam_Id == item.Exam_Id);
                                    var ExamT = db.tbl_Exam.Single(a => a.Exam_Id == item.Exam_Id);


                                    int DegMCq = McqT.Sum(a => (int?)a.QuestionMCQ_Mark) ?? 0;
                                    int DegTF = TFT.Sum(a => (int?)a.QuestionTrueFalse_Mark) ?? 0;

                                    int Total = DegMCq + DegTF;
                                    int TotalExam = ExamT.Exam_TotalMark;
                                    if (Total == TotalExam)
                                    {

                                        if (item.Exam_EndOn <= DateTime.Now)
                                        {

                                        }
                                        else
                                        {
                                            <div class="panel panel-default text-center" style="float: left;width: 250px; margin:20px;">
                                                <div class="panel-heading text-info">
                                                    <p style="font-size:15px">@Html.DisplayFor(modelItem => item.Exam_Name)</p>
                                                </div>
                                                <div class="panel-heading">
                                                    @Html.ActionLink("دخول الامتحان", "StartExam", "Student", new { id = item.Exam_Id }, new { @class = "btn btn-custom" })

                                                    <p class="text-success">  متاح  </p>
                                                </div>
                                            </div>
                                        }

                                    }


                                }
                            }

                            <div class="clearfix"></div>
                        </div>
                    </div>

                </div>
                <!-- container -->
                <div class="footer">
                    <div class="pull-right hide-phone">
                        محمد عيد 2020
                    </div>
                </div>

            </div> <!-- content -->

        </div>


        <!-- ============================================================== -->
        <!-- End Right content here -->
        <!-- ============================================================== -->


    </div>
    <!-- END wrapper -->
    <!-- jQuery  -->
    <script src="~/assets/js/jquery.min.js"></script>
    <script src="~/assets/js/popper.min.js"></script>
    <script src="~/assets/js/bootstrap.min.js"></script>
    <script src="~/assets/js/metisMenu.min.js"></script>
    <script src="~/assets/js/waves.js"></script>
    <script src="~/assets/js/jquery.slimscroll.js"></script>

    <!-- App js -->
    <script src="~/assets/js/jquery.core.js"></script>
    <script src="~/assets/js/jquery.app.js"></script>
    <script type="text/javascript">

    </script>

</body>
</html>